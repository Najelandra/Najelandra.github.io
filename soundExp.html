<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.11/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.11/addons/p5.sound.min.js"></script>
  </head>
  <body>
    <script>
      let mic, fft;

      function setup() {
        //createCanvas(256, 256);
        //colorMode(HSB);
        //angleMode(DEGREES);
        noCanvas();
        mic = new p5.AudioIn();
        mic.start();
        fft = new p5.FFT(0.9, 64);
        fft.setInput(mic);
        //w = width / 64;
      }

      function draw() {
        //background(0);
        let spectrum = fft.analyze();
        
        let energy = fft.getEnergy(1000, 5000);
        //console.log(energy)

        if (frameCount % 30 === 0 && window.AppInventor) {
          window.AppInventor.setWebViewString(spectrum[0]);
        }
  
          /*for (let i = 0; i < spectrum.length; i++) {
            let ampl = spectrum[i];
            fill(i, 255, 255);
            let y = map(ampl, 0, 256, height, 0);
            rect(i*w, y, w, height - y);
          }*/
        
      }
    </script>
  </body>
</html>












